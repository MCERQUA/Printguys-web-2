# TASK T004: Set Up Email Service (Resend)

## OBJECTIVE
Install and configure Resend for sending transactional emails.

## PROJECT LOCATION
/home/nick/Nick/Printguys-AI/printguys-nextjs

## CONTEXT
- Need email service for contact form and order confirmations
- Using Resend (modern email API, free tier available)
- Will create reusable email utility

## INSTRUCTIONS

1. Install Resend SDK:
```bash
cd /home/nick/Nick/Printguys-AI/printguys-nextjs
npm install resend
```

2. Add Resend API key to .env.local:
```
RESEND_API_KEY="re_xxxxx"  # Get from resend.com
EMAIL_FROM="Printguys <orders@printguys.ca>"
ADMIN_EMAIL="nick@printguys.ca"
```

3. Create email utility at /src/lib/email.ts:
```typescript
import { Resend } from 'resend'

const resend = new Resend(process.env.RESEND_API_KEY)

export interface SendEmailParams {
  to: string | string[]
  subject: string
  html: string
  text?: string
  replyTo?: string
}

export async function sendEmail({ to, subject, html, text, replyTo }: SendEmailParams) {
  try {
    const { data, error } = await resend.emails.send({
      from: process.env.EMAIL_FROM || 'Printguys <onboarding@resend.dev>',
      to: Array.isArray(to) ? to : [to],
      subject,
      html,
      text,
      replyTo,
    })

    if (error) {
      console.error('Email send error:', error)
      return { success: false, error }
    }

    return { success: true, data }
  } catch (error) {
    console.error('Email send exception:', error)
    return { success: false, error }
  }
}

// Email templates
export const emailTemplates = {
  contactConfirmation: (name: string) => ({
    subject: 'We received your message - Printguys',
    html: `
      <div style="font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;">
        <h1 style="color: #10b981;">Thanks for contacting us, ${name}!</h1>
        <p>We've received your message and will get back to you within 24 hours.</p>
        <p>In the meantime, feel free to check out our services at <a href="https://printguys.ca">printguys.ca</a></p>
        <hr style="border: 1px solid #e5e7eb; margin: 20px 0;" />
        <p style="color: #6b7280; font-size: 14px;">Printguys - Custom Print Solutions</p>
        <p style="color: #6b7280; font-size: 14px;">647-685-6286</p>
      </div>
    `
  }),

  contactNotification: (data: { name: string; email: string; phone?: string; message: string }) => ({
    subject: `New Contact Form: ${data.name}`,
    html: `
      <div style="font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;">
        <h1 style="color: #10b981;">New Contact Form Submission</h1>
        <table style="width: 100%; border-collapse: collapse;">
          <tr><td style="padding: 10px; border-bottom: 1px solid #e5e7eb;"><strong>Name:</strong></td><td>${data.name}</td></tr>
          <tr><td style="padding: 10px; border-bottom: 1px solid #e5e7eb;"><strong>Email:</strong></td><td><a href="mailto:${data.email}">${data.email}</a></td></tr>
          ${data.phone ? `<tr><td style="padding: 10px; border-bottom: 1px solid #e5e7eb;"><strong>Phone:</strong></td><td>${data.phone}</td></tr>` : ''}
          <tr><td style="padding: 10px; border-bottom: 1px solid #e5e7eb;"><strong>Message:</strong></td><td>${data.message}</td></tr>
        </table>
      </div>
    `
  }),

  orderConfirmation: (orderNumber: string, items: any[], total: number) => ({
    subject: `Order Confirmed #${orderNumber} - Printguys`,
    html: `
      <div style="font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;">
        <h1 style="color: #10b981;">Order Confirmed!</h1>
        <p>Thank you for your order. Your order number is <strong>#${orderNumber}</strong></p>
        <p>We'll send you another email when your order ships.</p>
        <h2>Order Summary</h2>
        <p><strong>Total:</strong> $${total.toFixed(2)}</p>
        <hr style="border: 1px solid #e5e7eb; margin: 20px 0;" />
        <p style="color: #6b7280; font-size: 14px;">Questions? Reply to this email or call 647-685-6286</p>
      </div>
    `
  })
}
```

4. Test by creating a simple test endpoint (optional):
```bash
# Create test at /src/app/api/test-email/route.ts
```

## OUTPUT
- Write results to: /home/nick/Nick/Printguys-AI/printguys-nextjs/z-code-outputs/agent2-T004.md
- Include all files created
- Note: If no Resend API key, document how to get one
- End with "TASK_COMPLETED" if successful or "TASK_FAILED: [reason]" if not

## CONSTRAINTS
- Don't expose API keys in code
- Use environment variables
- Create reusable templates
