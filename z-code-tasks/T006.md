# TASK T006: Make Orders Persist to Database

## OBJECTIVE
Ensure orders are saved to PostgreSQL database instead of memory.

## PROJECT LOCATION
/home/nick/Nick/Printguys-AI/printguys-nextjs

## CONTEXT
- Database should be connected (T001, T002 completed)
- Orders API should be updated (T003 completed)
- This task verifies and tests order persistence

## INSTRUCTIONS

1. Verify the Order model exists in schema:
```bash
cat /home/nick/Nick/Printguys-AI/printguys-nextjs/prisma/schema.prisma | grep -A 30 "model Order"
```

2. Check the orders API route:
```bash
cat /home/nick/Nick/Printguys-AI/printguys-nextjs/src/app/api/orders/route.ts
```

3. If not using Prisma, update to use Prisma (see T003)

4. Create comprehensive test:
```bash
# Test creating an order
curl -X POST http://localhost:3000/api/orders \
  -H "Content-Type: application/json" \
  -d '{
    "items": [{"name": "Test Shirt", "qty": 5, "price": 25}],
    "totalAmount": 125,
    "guestEmail": "test@example.com",
    "shippingAddress": {"street": "123 Test St", "city": "Toronto", "postal": "M5V1A1"}
  }'
```

5. Verify order was saved:
```bash
cd /home/nick/Nick/Printguys-AI/printguys-nextjs
npx prisma studio
# Or via psql
PGPASSWORD=printguys_secure_2026 psql -U printguys -d printguys -h localhost -c "SELECT * FROM orders LIMIT 5;"
```

6. Test fetching orders (requires auth, so test with browser/Postman)

7. Add order status tracking if not present:
- pending -> processing -> printing -> shipped -> delivered

## OUTPUT
- Write results to: /home/nick/Nick/Printguys-AI/printguys-nextjs/z-code-outputs/agent3-T006.md
- Include test results
- Confirm data persists after server restart
- End with "TASK_COMPLETED" if successful or "TASK_FAILED: [reason]" if not

## CONSTRAINTS
- Don't delete any existing orders
- Maintain backward compatibility
- Test thoroughly
