# TASK T012: Add Order Confirmation Emails

## OBJECTIVE
Send confirmation emails when orders are placed and paid.

## PROJECT LOCATION
/home/nick/Nick/Printguys-AI/printguys-nextjs

## CONTEXT
- Email service should exist (T004 completed)
- Stripe webhook should exist (T010 completed)
- Need to send emails at key order stages

## INSTRUCTIONS

1. Verify email templates exist in /src/lib/email.ts

2. Add more order-related templates if needed:
```typescript
// Add to emailTemplates in /src/lib/email.ts

orderReceived: (order: any) => ({
  subject: `Order Received #${order.orderNumber} - Printguys`,
  html: `
    <div style="font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;">
      <div style="background: #10b981; color: white; padding: 20px; text-align: center;">
        <h1 style="margin: 0;">Order Received!</h1>
      </div>
      <div style="padding: 20px;">
        <p>Hi ${order.customerName || 'there'},</p>
        <p>We've received your order <strong>#${order.orderNumber}</strong> and it's being reviewed.</p>

        <h2 style="color: #10b981;">Order Details</h2>
        <table style="width: 100%; border-collapse: collapse;">
          <tr style="background: #f3f4f6;">
            <td style="padding: 10px; border: 1px solid #e5e7eb;"><strong>Order Number</strong></td>
            <td style="padding: 10px; border: 1px solid #e5e7eb;">#${order.orderNumber}</td>
          </tr>
          <tr>
            <td style="padding: 10px; border: 1px solid #e5e7eb;"><strong>Total</strong></td>
            <td style="padding: 10px; border: 1px solid #e5e7eb;">$${order.totalAmount.toFixed(2)} CAD</td>
          </tr>
          <tr style="background: #f3f4f6;">
            <td style="padding: 10px; border: 1px solid #e5e7eb;"><strong>Status</strong></td>
            <td style="padding: 10px; border: 1px solid #e5e7eb;">Payment Received</td>
          </tr>
        </table>

        <h3>What's Next?</h3>
        <ol>
          <li>Our team will review your order and artwork</li>
          <li>We'll begin production within 24 hours</li>
          <li>You'll receive a shipping notification when your order ships</li>
        </ol>

        <p>Questions? Reply to this email or call us at <strong>647-685-6286</strong></p>
      </div>
      <div style="background: #1f2937; color: #9ca3af; padding: 20px; text-align: center; font-size: 14px;">
        <p>Printguys - Custom Print Solutions</p>
        <p>Greater Toronto Area, Canada</p>
      </div>
    </div>
  `
}),

orderShipped: (order: any, trackingNumber: string, carrier: string) => ({
  subject: `Your Order Has Shipped! #${order.orderNumber} - Printguys`,
  html: `
    <div style="font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;">
      <div style="background: #3b82f6; color: white; padding: 20px; text-align: center;">
        <h1 style="margin: 0;">Your Order Has Shipped!</h1>
      </div>
      <div style="padding: 20px;">
        <p>Great news! Your order <strong>#${order.orderNumber}</strong> is on its way.</p>

        <div style="background: #f3f4f6; padding: 15px; border-radius: 8px; margin: 20px 0;">
          <p style="margin: 0;"><strong>Tracking Number:</strong> ${trackingNumber}</p>
          <p style="margin: 10px 0 0;"><strong>Carrier:</strong> ${carrier}</p>
        </div>

        <p>You can track your package using the tracking number above.</p>

        <p>Thank you for choosing Printguys!</p>
      </div>
    </div>
  `
}),

adminNewOrder: (order: any) => ({
  subject: `ðŸ›’ New Order #${order.orderNumber} - $${order.totalAmount.toFixed(2)}`,
  html: `
    <div style="font-family: Arial, sans-serif;">
      <h1>New Order Received!</h1>
      <p><strong>Order #:</strong> ${order.orderNumber}</p>
      <p><strong>Total:</strong> $${order.totalAmount.toFixed(2)} CAD</p>
      <p><strong>Customer:</strong> ${order.customerEmail || 'Guest'}</p>
      <p><strong>Items:</strong> ${JSON.stringify(order.items, null, 2)}</p>
      <a href="https://printguys.ca/admin/orders/${order.id}" style="display: inline-block; background: #10b981; color: white; padding: 10px 20px; text-decoration: none; border-radius: 4px;">View Order</a>
    </div>
  `
})
```

3. Update Stripe webhook to send customer email:
- Already should be in T010, verify it works

4. Send admin notification on new order:
```typescript
// In the webhook handler, after updating order:
const adminTemplate = emailTemplates.adminNewOrder(order)
await sendEmail({
  to: process.env.ADMIN_EMAIL || 'nick@printguys.ca',
  subject: adminTemplate.subject,
  html: adminTemplate.html,
})
```

5. Test the flow:
- Create test order
- Verify customer receives confirmation
- Verify admin receives notification

## OUTPUT
- Write results to: /home/nick/Nick/Printguys-AI/printguys-nextjs/z-code-outputs/agent5-T012.md
- Include all templates added
- End with "TASK_COMPLETED" if successful or "TASK_FAILED: [reason]" if not

## CONSTRAINTS
- Don't spam emails during testing
- Use test email addresses
- Make emails mobile-friendly
